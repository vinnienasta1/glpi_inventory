# Инструкция по установке плагина "Инвенторизация" для GLPI

## Требования

- GLPI 10.0.0 или выше
- PHP 7.4 или выше
- Расширения PHP: `dom`, `mbstring`
- (Опционально) `zip` — требуется только для XLSX-актов. Для HTML-актов не нужен
- Права администратора в GLPI

## Установка плагина

### Шаг 1: Копирование файлов

1. Скопируйте все файлы плагина в папку `plugins` вашей установки GLPI. ВАЖНО: имя каталога плагина должно быть строго `inventory`:
   ```
   /path/to/glpi/plugins/inventory/
   ```

2. Структура должна выглядеть следующим образом:
   ```
   /path/to/glpi/plugins/inventory/
   ├── setup.php
   ├── inc/
   │   └── inventory.class.php
   ├── front/
   │   └── inventory.php
   ├── ajax/
   │   ├── search.php
   │   ├── update.php
   │   ├── templates.php
   │   ├── generate_act.php
   │   └── generate_act_html.php
   ├── css/
   │   └── inventory.css
   ├── js/
   │   ├── inventory.js
   │   └── inventory_import_export.js
   ├── templates/
   │   ├── giveing.html
   │   ├── return.html
   │   └── sale.html
   └── locales/
       ├── ru_RU.po
       └── en_US.po
   ```

### Шаг 2: Установка через веб-интерфейс

1. Войдите в GLPI как администратор
2. Перейдите в **Администрирование → Плагины**
3. Найдите в списке плагин "Инвенторизация" (inventory)
4. Нажмите кнопку **"Установить"**
5. После успешной установки нажмите **"Включить"**

### Шаг 3: Проверка установки

1. В левом меню GLPI перейдите в раздел **"Инструменты"**
2. Должен появиться пункт **"Инвенторизация"**
3. Нажмите на него для открытия страницы плагина

## Права доступа

Плагин доступен авторизованным пользователям. Отдельные профили/права не требуются.

## Возможные проблемы и решения

### Плагин не отображается в списке

**Причина:** Неправильная структура файлов или права доступа

**Решение:**
- Проверьте права доступа к файлам (должны быть readable для веб-сервера)
- Убедитесь, что каталог называется ровно `inventory`
- Убедитесь, что `setup.php` находится в корне папки плагина
- Проверьте логи веб-сервера на наличие ошибок

### Ошибка при установке

**Причина:** Не соответствие требованиям версии GLPI

**Решение:**
- Убедитесь, что версия GLPI 10.0.0 или выше
- Проверьте логи GLPI в разделе **Администрирование → Логи**

### Плагин не работает после установки

**Причина:** Проблемы с версиями/расширениями PHP или доступом к БД

**Решение:**
- Проверьте наличие расширений `dom`, `mbstring` (и `zip` при использовании XLSX)
- Убедитесь, что пользователь БД имеет права на чтение таблиц оборудования (`glpi_computers`, `glpi_monitors`, `glpi_peripherals`)

### AJAX-поиск не работает

**Причина:** Проблемы с JavaScript или путями к файлам

**Решение:**
- Откройте консоль разработчика в браузере (F12) и вкладку Network
- Проверьте ошибки JavaScript
- Убедитесь, что файлы CSS и JS доступны по указанным путям
- Убедитесь, что вы авторизованы (плагин недоступен анонимно)

### HTML-акты печатаются с колонтитулами

**Причина:** Настройки печати браузера

**Решение:**
- В диалоге печати отключите «Заголовки и колонтитулы»
- Макет печати уже включает `@page { margin: 0 }`

## Деинсталляция

1. В **Администрирование → Плагины** найдите плагин "Инвенторизация"
2. Нажмите **"Отключить"**
3. Нажмите **"Удалить"**
4. Удалите папку `plugins/inventory/` с сервера

## Поддержка

При возникновении проблем:
1. Проверьте логи GLPI
2. Проверьте логи веб-сервера
3. Убедитесь в соответствии требованиям системы
